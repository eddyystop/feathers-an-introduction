
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>A database connector Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="rest-api-server.html" />
    
    
    <link rel="prev" href="readme.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../readme.html">
            
                <a href="../readme.html">
            
                    
                    Step by step intro to basic Feathers >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../intro/readme.html">
            
                <a href="../intro/readme.html">
            
                    
                    Introduction >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../intro/not-worry.html">
            
                <a href="../intro/not-worry.html">
            
                    
                    What not to worry about
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="readme.html">
            
                <a href="readme.html">
            
                    
                    Basic Feathers >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.2.1" data-path="database-connector.html">
            
                <a href="database-connector.html">
            
                    
                    A database connector
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="rest-api-server.html">
            
                <a href="rest-api-server.html">
            
                    
                    A REST API server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="rest-client.html">
            
                <a href="rest-client.html">
            
                    
                    A Feathers REST client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="socket-client.html">
            
                <a href="socket-client.html">
            
                    
                    A Feathers websocket client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="ah-ha.html">
            
                <a href="ah-ha.html">
            
                    
                    The "ah-ha" moment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" data-path="hooks-1.html">
            
                <a href="hooks-1.html">
            
                    
                    Hooks, part 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.7" data-path="hooks-2.html">
            
                <a href="hooks-2.html">
            
                    
                    Hooks, part 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.8" data-path="real-time.html">
            
                <a href="real-time.html">
            
                    
                    Real-time
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../generators/readme.html">
            
                <a href="../generators/readme.html">
            
                    
                    Generators >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="../generators/app.html">
            
                <a href="../generators/app.html">
            
                    
                    Generating an app
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="../generators/service.html">
            
                <a href="../generators/service.html">
            
                    
                    Adding a service
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../what-next.html">
            
                <a href="../what-next.html">
            
                    
                    What's next?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../production-ready.html">
            
                <a href="../production-ready.html">
            
                    
                    Is Feathers production ready?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../appendix/readme.html">
            
                <a href="../appendix/readme.html">
            
                    
                    Appendix >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" data-path="../appendix/what-is-this.html">
            
                <a href="../appendix/what-is-this.html">
            
                    
                    What is 'this'?
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../chat/readme.html">
            
                <a href="../../chat/readme.html">
            
                    
                    Writing a chat room app >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../chat/server/readme.html">
            
                <a href="../../chat/server/readme.html">
            
                    
                    Server >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../chat/server/start-server.html">
            
                <a href="../../chat/server/start-server.html">
            
                    
                    Starting the server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../../chat/server/start-front-end.html">
            
                <a href="../../chat/server/start-front-end.html">
            
                    
                    Starting the front-end
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../../chat/server/finish-server.html">
            
                <a href="../../chat/server/finish-server.html">
            
                    
                    Finishing the server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="../../chat/server/user-mgnt.html">
            
                <a href="../../chat/server/user-mgnt.html">
            
                    
                    User management
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../chat/client/readme.html">
            
                <a href="../../chat/client/readme.html">
            
                    
                    Client >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../../chat/client/jQuery.html">
            
                <a href="../../chat/client/jQuery.html">
            
                    
                    jQuery client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../../chat/client/oauth.html">
            
                <a href="../../chat/client/oauth.html">
            
                    
                    OAuth jQuery client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../../chat/client/other-clients.html">
            
                <a href="../../chat/client/other-clients.html">
            
                    
                    Clients for other frameworks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../chat/what-next.html">
            
                <a href="../../chat/what-next.html">
            
                    
                    What's next?
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../adapters/readme.html">
            
                <a href="../../adapters/readme.html">
            
                    
                    Adapters >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../adapters/redux-services/readme.html">
            
                <a href="../../adapters/redux-services/readme.html">
            
                    
                    Redux for Feathers services >>
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../adapters/redux-auth/readme.html">
            
                <a href="../../adapters/redux-auth/readme.html">
            
                    
                    Redux for Feathers authentication >>
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >A database connector</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="writing-a-database-connector">Writing a Database Connector</h1>
<p>Our first Feathers example resides on the server only.
We&apos;ll see how easy it is to use a database table.</p>
<p>The example adds some user items to a NeDB database table,
reads them back and displays them.</p>
<blockquote>
<p><strong>Databases.</strong> We&apos;re using the NeDB database because it won&apos;t distract us
from concentrating on Feathers. NeDB resembles the popular MongoDB database
but requires neither installation nor configuration.</p>
<p>Feathers supports over 20 different databases.
Everything we mention in this guide is applicable to all of them.</p>
</blockquote>
<h2 id="working-example">Working example</h2>
<p>| Source code: <a href="https://github.com/eddyystop/feathers-an-introduction/blob/master/examples/step/01/db-connector/1.js" target="_blank">db-connector/1.js.</a></p>
<p>| Run it: <code>node ./examples/step/01/db-connector/1.js</code></p>
<h2 id="feathers-is-modular">Feathers is modular</h2>
<p>Feathers embodies the same spirit as the popular HTTP server framework <a href="http://expressjs.com/" target="_blank">Express</a> .
It is comprised of small modules that are all completely optional,
and the core weighs in at just a few hundred lines of code.
How&apos;s that for light weight!
Now you can see where Feathers got its name.</p>
<h2 id="implementing-a-database-connector">Implementing a database connector</h2>
<p>| View complete file <a href="https://github.com/eddyystop/feathers-an-introduction/blob/master/examples/step/01/db-connector/1.js" target="_blank">db-connector/1.js.</a></p>
<h4 id="we-require-our-dependencies">We <code>require</code> our dependencies.</h4>
<pre><code class="lang-javascript">
<span class="hljs-keyword">const</span> NeDB = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;nedb&apos;</span>);
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;path&apos;</span>);
<span class="hljs-keyword">const</span> feathers = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers&apos;</span>);
<span class="hljs-keyword">const</span> service = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-nedb&apos;</span>);
</code></pre>
<h4 id="we-start-an-instance-of-feathers-and-define-its-services">We start an instance of Feathers and define its services.</h4>
<pre><code class="lang-javascript">
<span class="hljs-keyword">const</span> app = feathers()
  .configure(services);
</code></pre>
<p>users is the only service we need  and its a database table located at examples/step/data/users.db.</p>
<pre><code class="lang-javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">services</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.use(<span class="hljs-string">&apos;/users&apos;</span>, service({ Model: userModel() }));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">userModel</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> NeDB({
    filename: path.join(<span class="hljs-string">&apos;examples&apos;</span>, <span class="hljs-string">&apos;step&apos;</span>, <span class="hljs-string">&apos;data&apos;</span>, <span class="hljs-string">&apos;users.db&apos;</span>),
    autoload: <span class="hljs-literal">true</span>
  });
}
</code></pre>
<h4 id="create-3-users-using-promises">Create 3 users using Promises.</h4>
<pre><code class="lang-javascript">
<span class="hljs-keyword">const</span> users = app.service(<span class="hljs-string">&apos;users&apos;</span>);

<span class="hljs-built_in">Promise</span>.all([
  users.create({ email: <span class="hljs-string">&apos;jane.doe@gmail.com&apos;</span>, password: <span class="hljs-string">&apos;X2y6&apos;</span>, role: <span class="hljs-string">&apos;admin&apos;</span> }),
  users.create({ email: <span class="hljs-string">&apos;john.doe@gmail.com&apos;</span>, password: <span class="hljs-string">&apos;i6He&apos;</span>, role: <span class="hljs-string">&apos;user&apos;</span> }),
  users.create({ email: <span class="hljs-string">&apos;judy.doe@gmail.com&apos;</span>, password: <span class="hljs-string">&apos;7jHw&apos;</span>, role: <span class="hljs-string">&apos;user&apos;</span> })
])
</code></pre>
<p>Each create returns a promise which resolves into the item added into the database.
NeDB will always adds a unique <code>_id</code> property to the user item and the returned item will contain it.</p>
<blockquote>
<p><strong>Callbacks and Promises.</strong>
<code>users.create({ ... }, {}, (err, data) =&gt; { ... })</code>
would create a user item using a callback signature.
We however will use Promises in this guide because the
Feathers team prioritizes them.</p>
<p><strong> Promise Refresher.</strong> <code>Promise.all([ ... ]).then(results =&gt; { ... });</code>
Promise.all takes an array whose elements are JavaScript values or Promises.
It resolves each element, i.e. it waits for any async Promise to complete.
The elements are resolved in parallel, not sequentially,
so Promise.all is a great pattern with which to start independent actions.
The <code>then</code> portion is called once all elements are resolved.
It receives an array as a parameter.
The n-th element of the array is the resolved value of the n-th element in Promise.all.</p>
</blockquote>
<p>The 3 user items are now are in the database, their values are returned in <code>results</code>.
We issue a find for the entire table and print the results.</p>
<pre><code class="lang-javascript">
  .then(results =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;created Jane Doe item\n&apos;</span>, results[<span class="hljs-number">0</span>]);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;created John Doe item\n&apos;</span>, results[<span class="hljs-number">1</span>]);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;created Judy Doe item\n&apos;</span>, results[<span class="hljs-number">2</span>]);

    users.find()
      .then(results =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;find all items\n&apos;</span>, results))
  })
  .catch(err =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;Error occurred:&apos;</span>, err));
</code></pre>
<blockquote>
<p><strong> Promise Refresher.</strong> <code>user.find().then(results =&gt; ...);</code>
<code>user.find()</code> returns a Promise. <code>.then(results =&gt; ...)</code> waits for the Promise to resolve,
i.e. for the find to finish.
The zero, one or more items found in the table are returned in the <code>results</code> param.</p>
</blockquote>
<h2 id="service-methods">Service methods</h2>
<p>Feathers provides the following service methods:</p>
<pre><code class="lang-javascript">find(params)
get(id, params)
create(data, params)
update(id, data, params)
patch(id, data, params)
remove(id, params)
</code></pre>
<p><code>params</code> may be <code>{ query: { ... }, ... }</code> for <code>find</code>,
and for <code>remove</code> if <code>id</code> is <code>null</code>.</p>
<h2 id="results">Results</h2>
<p>Run the program using <code>node ./examples/step/01/db-connector/1.js</code>.
The console displays:</p>
<pre><code class="lang-text">feathers-an-introduction$ node ./examples/step/01/a/1
created Jane Doe item
 { email: &apos;jane.doe@gmail.com&apos;,
  password: &apos;X2y6&apos;,
  role: &apos;admin&apos;,
  _id: &apos;6Rq7O4RPYEO2TdAn&apos; }
created John Doe item
 { email: &apos;john.doe@gmail.com&apos;,
  password: &apos;i6He&apos;,
  role: &apos;user&apos;,
  _id: &apos;Q2bnsBRfO1ScqoqY&apos; }
created Judy Doe item
 { email: &apos;judy.doe@gmail.com&apos;,
  password: &apos;7jHw&apos;,
  role: &apos;user&apos;,
  _id: &apos;Tymf6Nailusd5MZD&apos; }
find all items
 [ { email: &apos;jane.doe@gmail.com&apos;,
    password: &apos;X2y6&apos;,
    role: &apos;admin&apos;,
    _id: &apos;6Rq7O4RPYEO2TdAn&apos; },
  { email: &apos;john.doe@gmail.com&apos;,
    password: &apos;i6He&apos;,
    role: &apos;user&apos;,
    _id: &apos;Q2bnsBRfO1ScqoqY&apos; },
  { email: &apos;judy.doe@gmail.com&apos;,
    password: &apos;7jHw&apos;,
    role: &apos;user&apos;,
    _id: &apos;Tymf6Nailusd5MZD&apos; } ]
</code></pre>
<blockquote>
<p><strong>Boilerplate.</strong> Feathers requires little boilerplate.
It took only 15 lines of code to connect to a database.</p>
</blockquote>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="readme.html" class="navigation navigation-prev " aria-label="Previous page: Basic Feathers >>">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="rest-api-server.html" class="navigation navigation-next " aria-label="Next page: A REST API server">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"A database connector","level":"1.2.2.1","depth":3,"next":{"title":"A REST API server","level":"1.2.2.2","depth":3,"path":"step-by-step/basic-feathers/rest-api-server.md","ref":"step-by-step/basic-feathers/rest-api-server.md","articles":[]},"previous":{"title":"Basic Feathers >>","level":"1.2.2","depth":2,"path":"step-by-step/basic-feathers/readme.md","ref":"step-by-step/basic-feathers/readme.md","articles":[{"title":"A database connector","level":"1.2.2.1","depth":3,"path":"step-by-step/basic-feathers/database-connector.md","ref":"step-by-step/basic-feathers/database-connector.md","articles":[]},{"title":"A REST API server","level":"1.2.2.2","depth":3,"path":"step-by-step/basic-feathers/rest-api-server.md","ref":"step-by-step/basic-feathers/rest-api-server.md","articles":[]},{"title":"A Feathers REST client","level":"1.2.2.3","depth":3,"path":"step-by-step/basic-feathers/rest-client.md","ref":"step-by-step/basic-feathers/rest-client.md","articles":[]},{"title":"A Feathers websocket client","level":"1.2.2.4","depth":3,"path":"step-by-step/basic-feathers/socket-client.md","ref":"step-by-step/basic-feathers/socket-client.md","articles":[]},{"title":"The \"ah-ha\" moment","level":"1.2.2.5","depth":3,"path":"step-by-step/basic-feathers/ah-ha.md","ref":"step-by-step/basic-feathers/ah-ha.md","articles":[]},{"title":"Hooks, part 1","level":"1.2.2.6","depth":3,"path":"step-by-step/basic-feathers/hooks-1.md","ref":"step-by-step/basic-feathers/hooks-1.md","articles":[]},{"title":"Hooks, part 2","level":"1.2.2.7","depth":3,"path":"step-by-step/basic-feathers/hooks-2.md","ref":"step-by-step/basic-feathers/hooks-2.md","articles":[]},{"title":"Real-time","level":"1.2.2.8","depth":3,"path":"step-by-step/basic-feathers/real-time.md","ref":"step-by-step/basic-feathers/real-time.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["feathers-collapsible-menu","heading-anchors","include-codeblock"],"pluginsConfig":{"search":{},"lunr":{"maxIndexSize":1000000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"heading-anchors":{},"highlight":{},"include-codeblock":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"feathers-collapsible-menu":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css"}},"file":{"path":"step-by-step/basic-feathers/database-connector.md","mtime":"2017-01-10T15:08:49.609Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-01-11T03:03:26.946Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-feathers-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.2.1/anchor.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-heading-anchors/anchor-style.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

